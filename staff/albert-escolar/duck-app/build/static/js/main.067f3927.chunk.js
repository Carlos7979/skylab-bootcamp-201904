(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,n){e.exports=n(18)},17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(9),i=n.n(o),s=(n(17),n(2)),u=n(7),c=n(4),l=n(1),m=n(3),g={undefinedOrNull:function(e){return"null"===e?null:"undefined"!==e?e:void 0}},h=n(5),p=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(m.a)(t,e),t}(Object(h.a)(Error)),d=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(m.a)(t,e),t}(Object(h.a)(Error)),f=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(m.a)(t,e),t}(Object(h.a)(Error)),v=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(m.a)(t,e),t}(Object(h.a)(Error)),_=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(m.a)(t,e),t}(Object(h.a)(Error)),y=function(e){function t(e){return Object(s.a)(this,t),Object(c.a)(this,Object(l.a)(t).call(this,e))}return Object(m.a)(t,e),t}(Object(h.a)(Error)),E={arguments:function(e){e.forEach(function(e){var t=e.name,n=e.value,r=e.type,a=e.notEmpty,o=e.optional;if(void 0!=n){if(typeof n!==r)throw TypeError("".concat(t," ").concat(n," is not a ").concat(r));if(a)if("string"===r){if(!n.trim().length)throw new p("".concat(t," is empty"))}else if("object"===r&&!Object.keys(n).length)throw new p("".concat(t," is empty"))}else if(!o)throw new f("".concat(t," is not optional"))})},email:function(e){if(!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e)))throw new d("".concat(e," is not an e-mail"))},url:function(e){if(!/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(String(e)))throw new d("".concat(e," is not a url"))}},b=n(10);var w=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.method,a=void 0===r?"GET":r,o=n.headers,i=n.body,s=n.timeout,u=void 0===s?0:s;if(E.arguments([{name:"url",value:e,type:"string",notEmpty:!0},{name:"method",value:a,type:"string",notEmpty:!0},{name:"headers",value:o,type:"object",optional:!0},{name:"body",value:i,type:"string",notEmpty:!0,optional:!0},{name:"timeout",value:u,type:"number",notEmpty:!0,optional:!0}]),E.url(e),u){var c=new AbortController;t=c.signal,setTimeout(function(){return c.abort()},u)}return fetch(e,{method:a,headers:o,body:i,signal:t}).catch(function(e){throw e instanceof TypeError?new v("cannot connect"):e instanceof DOMException?new _("time out, exceeded limit of ".concat(u,"ms")):e})},O={__url__:"https://skylabcoders.herokuapp.com/api",__timeout__:0,create:function(e,t,n){return E.arguments([{name:"username",value:e,type:"string",notEmpty:!0},{name:"password",value:t,type:"string",notEmpty:!0},{name:"data",value:n,type:"object",notEmpty:!0,optional:!0}]),w("".concat(this.__url__,"/user"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(b.a)({username:e,password:t},n)),timeout:this.__timeout__}).then(function(e){return e.json()})},authenticate:function(e,t){return E.arguments([{name:"username",value:e,type:"string",notEmpty:!0},{name:"password",value:t,type:"string",notEmpty:!0}]),w("".concat(this.__url__,"/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t}),timeout:this.__timeout__}).then(function(e){return e.json()})},retrieve:function(e,t){return E.arguments([{name:"id",value:e,type:"string",notEmpty:!0},{name:"token",value:t,type:"string",notEmpty:!0}]),w("".concat(this.__url__,"/user/").concat(e),{headers:{Authorization:"Bearer ".concat(t)},timeout:this.__timeout__}).then(function(e){return e.json()})},update:function(e,t,n){return E.arguments([{name:"id",value:e,type:"string",notEmpty:!0},{name:"token",value:t,type:"string",notEmpty:!0},{name:"data",value:n,type:"object",notEmpty:!0}]),w("".concat(this.__url__,"/user/").concat(e),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(n),timeout:this.__timeout__}).then(function(e){return e.json()})}},j={__url__:"https://duckling-api.herokuapp.com/api",searchDucks:function(e){return E.arguments([{name:"query",value:e,type:"string"}]),w("".concat(this.__url__,"/search?q=").concat(e)).then(function(e){return e.json()})},retrieveDuck:function(e){return E.arguments([{name:"id",value:e,type:"string"}]),w("".concat(this.__url__,"/ducks/").concat(e)).then(function(e){return e.json()})}},k={set __userId__(e){sessionStorage.userId=e},get __userId__(){return g.undefinedOrNull(sessionStorage.userId)},set __userToken__(e){sessionStorage.userToken=e},get __userToken__(){return g.undefinedOrNull(sessionStorage.userToken)},get isUserLoggedIn(){return!(!this.__userId__||!this.__userToken__)},registerUser:function(e,t,n,r){return E.arguments([{name:"name",value:e,type:"string",notEmpty:!0},{name:"surname",value:t,type:"string",notEmpty:!0},{name:"email",value:n,type:"string",notEmpty:!0},{name:"password",value:r,type:"string",notEmpty:!0}]),E.email(n),O.create(n,r,{name:e,surname:t}).then(function(e){if("OK"!==e.status)throw new y(e.error)})},loginUser:function(e,t){var n=this;return E.arguments([{name:"email",value:e,type:"string",notEmpty:!0},{name:"password",value:t,type:"string",notEmpty:!0}]),E.email(e),O.authenticate(e,t).then(function(e){if("OK"!==e.status)throw new y(e.error);var t=e.data,r=t.id,a=t.token;n.__userId__=r,n.__userToken__=a})},retrieveUser:function(){return O.retrieve(this.__userId__,this.__userToken__).then(function(e){if("OK"===e.status){var t=e.data;return{name:t.name,surname:t.surname,email:t.username}}throw new y(e.error)})},logoutUser:function(){sessionStorage.clear()},searchDucks:function(e){return E.arguments([{name:"query",value:e,type:"string"}]),j.searchDucks(e)},retrieveDuck:function(e){return E.arguments([{name:"id",value:e,type:"string"}]),j.retrieveDuck(e)},toggleFavDuck:function(e){var t=this;return O.retrieve(this.__userId__,this.__userToken__).then(function(n){var r=n.status,a=n.data;if("OK"===r){var o=a.favs,i=void 0===o?[]:o,s=i.indexOf(e);return s<0?i.push(e):i.splice(s,1),O.update(t.__userId__,t.__userToken__,{favs:i}).then(function(){})}throw new y(n.error)})},retrieveFavDucks:function(){return O.retrieve(this.__userId__,this.__userToken__).then(function(e){var t=e.status,n=e.data;if("OK"===t){var r=n.favs,a=void 0===r?[]:r;if(a.length){var o=a.map(function(e){return j.retrieveDuck(e)});return Promise.all(o)}return a}throw new y(e.error)})}},S={set language(e){localStorage.lang=e},get language(){return localStorage.lang||"en"}};var T=function(e){var t=e.lang,n=e.onLanguageChange;return a.a.createElement("select",{onChange:function(e){return n(e.target.value)},value:t},a.a.createElement("option",{value:"en"},"English"),a.a.createElement("option",{value:"es"},"Espa\xf1ol"),a.a.createElement("option",{value:"ca"},"Catal\xe0"),a.a.createElement("option",{value:"ga"},"Galego"))},C={en:{register:"Register",or:"or",login:"Login"},es:{register:"Reg\xedstrate",or:"o",login:"Inicia sesi\xf3n"},ca:{register:"Registra't",or:"o",login:"Inicia sessi\xf3"},ga:{register:"Rexistrese",or:"ou",login:"Inicia sesi\xf3n"}};var I=function(e){var t=e.lang,n=e.onRegister,r=e.onLogin,o=C[t],i=o.register,s=o.or,u=o.login;return a.a.createElement("section",{onClick:function(e){return e.preventDefault()}},a.a.createElement("a",{href:"",onClick:function(){return n()}},i)," ",a.a.createElement("span",null,s)," ",a.a.createElement("a",{href:"",onClick:function(){return r()}},u),".")},L={en:{title:"Register",name:"Name",surname:"Surname",email:"E-mail",password:"Password"},es:{title:"Registro",name:"Nombre",surname:"Apellido",email:"E-milio",password:"Contrase\xf1a"},ca:{title:"Registre",name:"Nom",surname:"Cognom",email:"E-mil\xb7li",password:"Contrasenya"},ga:{title:"Rexistro",name:"Nome",surname:"Apelido",email:"E-mili\xf1o",password:"Contrasinal"}};var D=function(e){var t=e.lang,n=e.onRegister,r=e.error,o=L[t],i=o.title,s=o.name,u=o.surname,c=o.email,l=o.password;return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,i),a.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=e.target,r=t.name.value,a=t.surname.value,o=t.username.value,i=t.password.value;n(r,a,o,i)}},a.a.createElement("input",{type:"text",name:"name",placeholder:s}),a.a.createElement("input",{type:"text",name:"surname",placeholder:u}),a.a.createElement("input",{type:"text",name:"username",placeholder:c}),a.a.createElement("input",{type:"password",name:"password",placeholder:l}),a.a.createElement("button",null,i),a.a.createElement("span",null,r)))},U={en:{successProceedTo:"User successfully registered, you can proceed to",login:"Login"},es:{successProceedTo:"[TODO es] User successfully registered, you can proceed to",login:"Iniciar sesi\xf3n"},ca:{successProceedTo:"[TODO ca] User successfully registered, you can proceed to",login:"Inici de sessi\xf3"},ga:{successProceedTo:"[TODO ga] User successfully registered, you can proceed to",login:"Inicio da sesi\xf3n"}};var R=function(e){var t=e.lang,n=e.onLogin,r=U[t],o=r.successProceedTo,i=r.login;return a.a.createElement(a.a.Fragment,null,o," ",a.a.createElement("a",{href:"",onClick:function(e){e.preventDefault(),n()}},i),".")},N={en:{title:"Login",email:"E-mail",password:"Password"},es:{title:"Iniciar sesi\xf3n",email:"E-milio",password:"Contrase\xf1a"},ca:{title:"Inici de sessi\xf3",email:"E-mil\xb7li",password:"Contrasenya"},ga:{title:"Inicio da sesi\xf3n",email:"E-mili\xf1o",password:"Contrasinal"}};var x=function(e){var t=e.lang,n=e.onLogin,r=e.error,o=N[t],i=o.title,s=o.email,u=o.password;return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,i),a.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=e.target.username.value,r=e.target.password.value;n(t,r)}},a.a.createElement("input",{type:"text",name:"username",placeholder:s}),a.a.createElement("input",{type:"password",name:"password",placeholder:u}),a.a.createElement("button",null,i),a.a.createElement("span",null,r)))},P={en:{hello:"Hello",logout:"Logout"},es:{hello:"Hola",logout:"Cerrar sesi\xf3n"},ca:{hello:"Hola",logout:"Tanca sessi\xf3"},ga:{hello:"Hola",logout:"Finalizar sesi\xf3n"}},A={en:{search:"Search"},es:{search:"Buscar"},ca:{search:"Cerca"},ga:{search:"Buscar"}};var F=function(e){var t=e.lang,n=e.onSearch,r=A[t].search;return a.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=e.target.query.value;n(t)}},a.a.createElement("input",{type:"text",name:"query"}),a.a.createElement("button",null,r))};var B=function(e){var t=e.items,n=e.onItem;return a.a.createElement("ul",null,t.map(function(e){var t=e.id,r=e.title,o=e.image,i=e.price;return a.a.createElement("li",{key:t,onClick:function(){return n(t)}},a.a.createElement("h2",null,r),a.a.createElement("img",{src:o}),a.a.createElement("span",null,i))}))};var q=function(e){var t=e.item,n=t.title,r=t.image,o=t.description,i=t.price;return a.a.createElement("section",null,a.a.createElement("h2",null,n),a.a.createElement("img",{src:r}),a.a.createElement("p",null,o),a.a.createElement("span",null,i))},z=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={error:null,ducks:[],duck:null},n.handleSearch=function(e){return k.searchDucks(e).then(function(e){return n.setState({duck:null,ducks:e.map(function(e){return{id:e.id,title:e.title,image:e.imageUrl,price:e.price}})})}).catch(function(e){return n.setState({error:e.message})})},n.handleRetrieve=function(e){return k.retrieveDuck(e).then(function(e){var t=e.title,r=e.imageUrl,a=e.description,o=e.price;return n.setState({duck:{title:t,image:r,description:a,price:o}})}).catch(function(e){return n.setState({error:e.message})})},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.handleSearch,t=this.handleRetrieve,n=this.state,r=n.ducks,o=n.duck,i=this.props,s=i.lang,u=i.name,c=i.onLogout,l=P[s],m=l.hello,g=l.logout;return a.a.createElement("main",null,a.a.createElement("h1",null,m,", ",u,"!"),a.a.createElement("button",{onClick:c},g),a.a.createElement(F,{lang:s,onSearch:e}),!o&&a.a.createElement(B,{items:r,onItem:t}),o&&a.a.createElement(q,{item:o}))}}]),t}(r.Component),J=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(a)))).state={lang:S.language,visible:k.isUserLoggedIn?"home":"landing",error:null,name:null},n.handleLanguageChange=function(e){return n.setState({lang:S.language=e})},n.handleRegisterNavigation=function(){return n.setState({visible:"register"})},n.handleLoginNavigation=function(){return n.setState({visible:"login"})},n.handleLogin=function(e,t){try{k.loginUser(e,t).then(function(){return k.retrieveUser()}).then(function(e){n.setState({visible:"home",name:e.name,error:null})}).catch(function(e){return n.setState({error:e.message})})}catch(a){var r=a.message;n.setState({error:r})}},n.handleRegister=function(e,t,r,a){try{k.registerUser(e,t,r,a).then(function(){return n.setState({visible:"register-ok",error:null})}).catch(function(e){return n.setState({error:e.message})})}catch(i){var o=i.message;n.setState({error:o})}},n.handleLogout=function(){k.logoutUser(),n.setState({visible:"landing"})},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;k.isUserLoggedIn&&k.retrieveUser().then(function(t){return e.setState({name:t.name})}).catch(function(t){return e.setState({error:t.message})})}},{key:"render",value:function(){var e=this.state,t=e.lang,n=e.visible,r=e.error,o=e.name,i=this.handleLanguageChange,s=this.handleRegisterNavigation,u=this.handleLoginNavigation,c=this.handleLogin,l=this.handleRegister,m=this.handleLogout;return a.a.createElement(a.a.Fragment,null,a.a.createElement(T,{lang:t,onLanguageChange:i}),"landing"===n&&a.a.createElement(I,{lang:t,onRegister:s,onLogin:u}),"register"===n&&a.a.createElement(D,{lang:t,onRegister:l,error:r}),"register-ok"===n&&a.a.createElement(R,{lang:t,onLogin:u}),"login"===n&&a.a.createElement(x,{lang:t,onLogin:c,error:r}),"home"===n&&a.a.createElement(z,{lang:t,name:o,onLogout:m}))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.067f3927.chunk.js.map